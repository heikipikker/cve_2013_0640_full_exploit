//cve-2013-0640 javascript obsfuscation code decode tool
//written:	vscen
//e-mail:	amdin@vscen.com
#include "de_obsfuscation.h"
#include "file_stream.h"
#include "string_decode.h"

int main(int argc, char* argv[]){
	vector<char> vec[2];
	FileStream::Get()->LoadFile("cve_2013_0640_malware_obsfuscation.js",vec[0]);
	vec[1].resize(vec[0].size()*2+sizeof(char));
	memset(&vec[1][0],0,vec[1].size());
	DeObsfuscation::Get()->Decode(&vec[0][0],&vec[1][0]);
	vec[0].resize(vec[1].size());
	memset(&vec[0][0],0,vec[0].size());
	StringDecode::Get()->ReplaceString("sHOGG",&vec[1][0],&vec[0][0]);
	FileStream::Get()->SaveFile("cve_2013_0640_malware.js",vec[0],strlen((const char*)&vec[0][0]));
	return 0;
}